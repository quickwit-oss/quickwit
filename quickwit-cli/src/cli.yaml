name: Quickwit
settings:
    - ArgRequiredElseHelp
subcommands:
    - index:
        about: Index operation commands such as `create`, `index`, or `search`...
        display_order: 1
        settings:
            - ArgRequiredElseHelp
        subcommands:
            - create:
                about: Creates an index.
                display_order: 1
                args:
                    - metastore-uri:
                        about: Location of the metastore.
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - index-config-uri:
                        about: Location of the index config file.
                        long: index-config-uri
                        value_name: INDEX CONFIG URI
                        required: true
                    - overwrite:
                        about: Overwrites pre-existing index.
                        long: overwrite
            - ingest:
                display_order: 2
                about: Indexes JSON documents read from a file or streamed from stdin.
                args:
                    - index-id:
                        about: ID of the target index.
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore.
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - input-path:
                        about: Location of the input file.
                        long: input-path
                        value_name: INPUT PATH
                    - data-dir-path:
                        about: Creates cached and intermediate data structures in this local directory.
                        long: data-dir-path
                        value_name: DATA DIR PATH
                        required: true
                    - overwrite:
                        about: Overwrites pre-existing index.
                        long: overwrite
            - describe:
                display_order: 3
                about: Display descriptive statistics about the index.
                args:
                    - index-id:
                        about: ID of the target index.
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore.
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
            - search:
                display_order: 4
                about: Searches an index.
                args:
                    - index-id:
                        about: id of the target index.
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore.
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - query:
                        about: Query expressed in Tantivy syntax.
                        long: query
                        value_name: QUERY
                        required: true
                    - max-hits:
                        about: Maximum number of hits returned.
                        long: max-hits
                        value_name: MAX HITS
                        default_value: '20'
                    - start-offset:
                        about: Offset in the global result set of the first hit returned.
                        long: start-offset
                        value_name: OFFSET
                        default_value: '0'
                    - search-fields:
                        about: Searches only in those fields.
                        long: search-fields
                        value_name: FIELD NAME
                        multiple_values: true
                    - start-timestamp:
                        about: Filters out documents before that timestamp (time-series indexes only).
                        long: start-timestamp
                        value_name: TIMESTAMP
                    - end-timestamp:
                        about: Filters out documents after that timestamp (time-series indexes only).
                        long: end-timestamp
                        value_name: TIMESTAMP
                    - tags:
                        about: Restricts search to splits matching the specified tags.
                        long: tags
                        value_name: TAG
                        multiple_values: true
            - merge:
                display_order: 4
                about: Merge an index.
                args:
                    - index-id:
                        about: Index ID
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - data-dir-path:
                        about: Creates indexing directories in this local directory.
                        long: data-dir-path
                        value_name: DATA DIR PATH
                        required: true
            - demux:
                display_order: 5
                about: Demuxes an index.
                args:
                    - index-id:
                        about: ID of the target index.
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore.
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - data-dir-path:
                        about: Creates indexing directories in this local directory.
                        long: data-dir-path
                        value_name: DATA DIR PATH
                        required: true
            - gc:
                display_order: 6
                about: Garbage collects stale staged splits and splits marked for deletion.
                args:
                    - index-id:
                        about: ID of the target index.
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore.
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - grace-period:
                        about: Threshold period after which stale staged splits are garbage collected.
                        long: grace-period
                        value_name: GRACE PERIOD
                        default_value: '1h'
                    - dry-run:
                        about: Executes the command in dry run mode and only displays the list of splits candidate for garbage collection.
                        long: dry-run
            - delete:
                display_order: 7
                about: Delete an index.
                args:
                    - index-id:
                        about: ID of the target index.
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore.
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - dry-run:
                        about: Executes the command in dry run mode and only displays the list of splits candidate for deletion.
                        long: dry-run
    - split:
        settings:
            - ArgRequiredElseHelp
        display_order: 2
        about: Operations (add, delete, describe...) on splits.
        subcommands:
            - extract:
                about: Downloads and extracts a split to a directory. 
                args:
                    - index-id:
                        about: ID of the target index.
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - split-id:
                        about: ID of the target split.
                        long: split-id
                        value_name: SPLIT ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore.
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - target-dir:
                        about: Directory to extract the split to.
                        long: target-dir
                        value_name: TARGET DIR
                        required: true
            - describe:
                about: Displays metadata about the split.
                args:
                    - index-id:
                        about: ID of the target index.
                        long: index-id
                        value_name: INDEX ID
                        required: true
                    - split-id:
                        about: ID of the target split.
                        long: split-id
                        value_name: SPLIT ID
                        required: true
                    - metastore-uri:
                        about: Location of the metastore.
                        long: metastore-uri
                        value_name: METASTORE URI
                        required: true
                        env: QUICKWIT_METASTORE_URI
                    - verbose:
                        about: Print also hotcache info.
                        long: verbose
    - service:
        about: Launches services.
        display_order: 3
        settings:
            - ArgRequiredElseHelp
        subcommands:
            - run:
                display_order: 1
                about: Starts a service. Currently, the only services available are `indexer` and `searcher`.
                args:
                    - service-name:
                        about: Name of the service.
                        value_name: SERVICE NAME
                        required: true
                    - server-config-uri:
                        about: Location of the server config.
                        long: server-config-uri
                        value_name: SERVER CONFIG URI
                        required: true
                    - index-id:
                        about: ID of the index to run the indexer for.
                        long: index-id
                        value_name: INDEX ID
    - tutorial:
        about: Get started quickly with one of our pre-configured datasets. No copy-paste needed.
        display_order: 4
        settings:
            - ArgRequiredElseHelp
        subcommands:
            - index:
                about: Indexes a dataset.
                args:
                    - name:
                        about: Name of the dataset.
                        long: name
                        value_name: DATASET NAME
                        required: true
